---
layout: post
title:  "프로젝트 코로나솔루션"
subtitle:   ""
categories: learn
tags : learn
comments: true
---
# 코로나솔루션

[https://github.com/HoseungJang/coronaSolution](https://github.com/HoseungJang/coronaSolution)

#### 코로나솔루션은 무엇인가

 중국에서 발생하여 전세계를 위협하고 있는 코로나바이러스의 진정에 조금이나마 도움이 되고 싶다는 생각으로부터 시작된 프로젝트입니다. 전체/시도별 환자 현황을 크롤링하여 제공하고, 선별진료소/국민안심병원 정보를 제공합니다.

## 얻은 점

#### 크롤링을 하면서 느낀점

 데이터를 크롤링하여 응답하는 서버는 처음 개발해보았습니다. 우선 크롤링이라는 새로운 경험을 해볼 수 있었다는 점에서 기분이 매우 좋습니다. 그리고 크롤링을 하며 여러 문제들과 마주했고, 동시에 많이 배웠던 것 같습니다. 가장 오래 시간을 지체했던 문제는 브라우저에서는 보이는 html 요소가 크롤링하여 가져왔을 때는 보이지 않는 문제였는데, 다른 요청을 통해서 js 파일을 얻어와 html을 조작하는 것이 당연히 가능하다는 것을 간과했던 제 실수였습니다. 그래도 인턴으로 근무하면서 진행한 프로젝트에서 간단히 웹 프론트엔드를 개발했던 경험 덕분에 나중에라도 깨달을 수 있어서 다행이었습니다. 프론트엔드와 백엔드가 서로 완전히 별개가 되는건 힘들다는 것을 깨달았습니다. 그리고 F12를 누르면 나오는 개발자 도구의 네트워크 탭에서 자바스크립트 코드를 살펴보는 소소한 재미도 있었습니다.

#### TypeScript 첫 사용기

 타입스크립트를 적용해보자고 다짐한 후로 타입스크립트 책만 열심히 읽어왔는데, 드디어 실제 서버 개발에 적용해보게 되었습니다. 자바스크립트만으로 개발할 때는 타입에러를 마주하게되는 일이 많았지만, 타입스크립트로 개발을 하니 일단 타입 문제가 있으면 에디터 상에서 바로바로 알 수 있었고, 사소하지만 가장 괴로운 골칫덩어리 하나가 줄어들어서 너무 좋았습니다. 자바스크립트만 써도 사실 문제는 없겠지만, 타입스크립트를 한번 써본 이상 타입스크립트 없이 Node.js 서버를 개발할 일은 앞으로 없을 것 같습니다.

#### 프로젝트 구조를 바꿔보았다..!

 코로나솔루션을 개발하기 전, 공동주택 공시가격을 제공해주는 프로젝트를 진행했었는데, 그 당시 일반적으로 볼 수 있는 express 프로젝트 구조에 굉장히 질려있었고, 조금 더 멋지고 깔끔한 아키텍쳐가 무엇일지 굉장히 고민했었던 기억이 납니다. 그래서 이번 프로젝트에서는 [새로운 아키텍쳐](https://velog.io/@hopsprings2/견고한-node.js-프로젝트-아키텍쳐-설계하기)를 적용해 보았습니다. 새로운 아키텍쳐에서 가장 인상깊었던 점은, 컨트롤러에 포함된 로직들을 전부 서비스 계층으로 분리한 것입니다. 컨트롤러에 들어가는 코드가 굉장히 깔끔하고 일관성있어져서 좋았고, 처리 로직들이 전부 서비스 계층의 함수들에 작성되기 때문에, 굳이 테스트코드를 작성할 때 supertest같은 모듈을 사용하여 요청/응답을 하지 않아도 된다는 것이 좋았습니다. 또한, 사실 그렇게 할 때보다 더 섬세한 테스트가 가능해졌다는 것이 좋았습니다. 그리고 각종 서비스들의 시작 코드들을 분리하여 loaders라는 디렉토리에 넣어두니 유지보수하기가 편했고, 무엇보다 Node.js 서버를 실행시키는 메인 파일이 매우 깔끔해져서 좋았습니다.

#### Sequelize에서 TypeORM 으로

 타입스크립트로 넘어와서도 시퀄라이즈를 계속 사용하는게 좋을지 고민을 많이했었습니다. 시퀄라이즈를 계속 사용해오면서 느낀 점은, 시퀄라이즈 관련 코드들이 상당히 복잡한 감이 있다는 것입니다.(특히 타입스크립트 적용시 더욱...) 물론 주관적인 시선이지만, 서버 개발을 혼자서 진행하기 때문에 굳이 사용법이 예뻐보이지 않는 ORM을 계속해서 사용할 이유가 없었습니다. 그래서 카카오톡 Node.js 오픈채팅방을 통해서 알게된 TypeORM을 사용해 보기로 하였습니다. 우선 전체적으로 시퀄라이즈의 모델보다 TypeORM의 엔티티가 훨씬 사용하기 편하다는 느낌을 받았습니다. 테이블을 정의하는 코드가 한눈에 들어와서 너무 좋았고, SQL Function을 QueryBuilder가 지원하지 않기 때문에 사용해보지는 못했지만, 체이닝 방식으로 SQL문을 만드는 QueryBuilder도 마음에 들었습니다. 버전은 0.2.x 밖에 안되었지만, 5.x.x 인 시퀄라이즈보다 훨씬 편하고 딱히 문제도 없었으니 앞으로 TypeORM으로 갈아타야겠습니다.

#### 깃허브의 또다른 용도

 지금까지 저에게 깃허브는 소스코드를 올려두는 저장소일 뿐이었습니다. 사실 소스코드를 올려두는 것 이외에 아주 많은 개발자분들이 올려놓은 Example 소스코드나, 각종 유용한 정보가 담긴 Repository들이 많다는 것을 알고는 있었지만, 정말 가끔 찾아보는 것이 전부였습니다. 하지만 이번 프로젝트에서는 소스코드를 작성할 때 워낙 새로운 것들이 많다보니 공식 문서나 블로그 글 만으로는 잘 이해가 안가는 부분이 많아서 깃허브에서 Example을 많이 찾아다녔던 것 같습니다. 확실히 여러 블로그를 돌아다니는 것 보다, 깃허브의 여러 Example을 둘러보는 것이 훨씬 더 도움이 되는 것 같았습니다. 블로그 글을 읽을 때에는 필자의 설명에 더 집중을 하게 되는데, 깃허브에서 Example을 둘러볼 때에는 해당 Example의 프로젝트 구조, 소스코드, 사용된 기술 등에 더 집중하게 되기 때문이었습니다. 이번 프로젝트가 매우 소규모여서 그렇게 많은 Example을 둘러보지 못했음에도 새롭고 흥미로운 기술들을 많이 접해서 좋았습니다.

## 마무리

 드디어 첫 타입스크립트 프로젝트가 마무리되었습니다. 처음 치고는 상당히 잘 완성한거 같아서 좋았습니다. 프로젝트에 갑자기 참가하게되어 급하게 개발하다보니 테스트코드 작성을 하지 않는 등 여러 허술한 부분이 많지만, 그래도 잘 마무리되어 다행입니다. 언제나 비슷한 구조의 코드가 질려가기 시작할 때 이런 새로운 느낌들이 확 들어오니 즐겁네요. 프로젝트의 재미는 새로운 것을 접하는 데에 있는 것 같습니다.