---
layout: post
title:  "프로젝트 대마장터"
subtitle:   ""
categories: project
tags : project
comments: true
---
# 대마장터

[https://github.com/DsmMarket](https://github.com/DsmMarket)

[https://github.com/DsmMarket/NodeServer](https://github.com/DsmMarket/NodeServer)

#### 대마장터는 무엇인가

 저는 대덕 소프트웨어 마이스터고등학교에 다니고 있습니다. 저희 학교는 전교생이 기숙사에서 생활합니다. 기숙사 생활을 하면서 편한 점도 있지만, 불편한 점도 분명히 존재하기 마련입니다.

 제가 기숙사 생활을 하면서 항상 느껴왔던 것은 물건을 사고 팔기가 힘들다는 것입니다. 외출이 자유롭지 않기 때문에 학교에서 물건을 받기 위해서는 택배를 기다려야 하고, 혹여나 택배를 집에 시켰거나, 자신의 물건을 택배로 보내기 위해서는 집에 가는 날까지 기다려야 합니다.

 따라서 학생들 사이의 물건 거래를 활성화 시키는 것이 중요하다고 생각했고, 교내 중고거래 서비스인 대마장터를 기획하게 되었습니다.

#### 다른 중고장터와 둔 차이점

 대마장터에는 거래 글도 올라오지만, 대여 글도 올라옵니다. 기존의 중고장터에서는 구매와 판매만 이루어 지고, 빌려주는 글을 본 적이 없었던 것 같습니다. 그래서 호기심에 제안했던 것이 대여 기능입니다.

 물건의 소유자는 1회당 가격 또는 시간 당 가격을 명시하여 게시글을 올리고, 사용자들은 게시자와 상의하여 물건을 대여합니다.

## 얻은 점

#### REST API 에 대한 이해가 조금은.. 향상

 대마장터 이전의 프로젝트에서는 REST API 설계의 기본을 실수했었습니다. url에 http 메소드를 집어넣거나, 행위에 대한 표현을 집어넣는 등 지금 돌아보면 부끄러운 실수를 했었습니다. 대마장터를 개발할 때도 그 실수를 반복했었는데, 그것을 개발 도중에 급하게 깨닫고 문서를 대규모로 수정해버리는 바람에 클라이언트 측에서 크게 고생을 하는 일이 생겼습니다. 작은 실수로 큰 문제를 일으키는 부끄러운 일을 했지만, 더 나은 개발자가 되기 위한 좋은 경험을 했다고 생각합니다.

#### 설계는 애초에 탄탄히 하자

 지금까지 해왔던 프로젝트들에 비하면, 대마장터는 규모가 컸습니다. 그래서 기능도 이전보다 훨씬 많았기 때문에 "일단 이 기능들부터 명세하고 나중에 하자" 라는 생각을 하고 개발을 시작했고, 결국 개발이 진행될 수록 "내가 정말 큰 실수를 했구나" 라는 생각이 들었습니다. 개발을 하면서 REST API 설계를 하다 보니 잦은 수정을 하게 됬고, 저를 포함한 팀원들이 갈수록 지쳤던 것 같습니다. 따라서 다음 부터는 REST API의 확실한 설계, 개발 시작 전 확실한 점검이 필요할 것 같다고 느꼈습니다.

#### 코드를 짜기 전에 한 번만 더 생각하자

 기능은 다 다르지만, 사실상 코드의 구조는 비슷했습니다. 그러다 보니 "이렇게 짜면 더 깔끔하고 처리가 단순해 지네?" 라는 생각을 정말 많이 했던 것 같습니다. 그런데 그게 어려운 발전이 아니었습니다. 한 발짝만 더 생각했으면 이끌어 낼 수 있었던 로직이었습니다. 따라서 개발을 하면서 무턱대고 코드를 짜지 말고, 생각을 하거나 그림을 그리는 등 코드를 최대한 개선시키는 것이 중요하다는 것을 느꼈습니다.

#### 자주 사용하는 코드는 미들웨어로 만들어두자

 이전 프로젝트들에서도 이번 프로젝트에서도 토큰 검사를 미들웨어로 만들었었는데, 정말 편리했고, 처리가 단순해 졌습니다. 앞으로는 미들웨어화 할 수 있는 코드는 무엇이 있을 지 고민해 보는 것도 좋을 것 같다고 느꼈습니다.

#### 적극적인 협업이 중요하구나..

 학교에서 동아리 친구들끼리 하던 프로젝트이고, 서로 일정이 다르다 보니 동아리 시간 마저도 '함께' 보다는 '개인' 이라는 느낌을 많이 받았습니다. 그러다 보니 팀 내에서 원활한 소통이 되지 않았고, 이로 인한 갈등이 생기는 등 협업이 제대로 이루어지지 않았던 것 같습니다. 그러다 보니 프로젝트는 점점 지체되고, 개발이 질린다는 느낌까지 받았습니다. 다시금 팀 내의 활발한 소통이 얼마나 중요한지 깨닫게 된 것 같습니다.

#### socket.io를 조금 더 깊이 사용해보다

 제가 지금까지 socket.io를 사용했던 경험이라곤 이전에 socket.io를 책에서 처음 배웠을 때 재미로 익명 채팅 웹 사이트를 개발하고, ngrok으로 외부에서 로컬에 접근할 수 있도록 허용하여 같은 반 친구들과 채팅을 하고 놀았던 경험 뿐이었습니다. 이때는 그냥 접속 하면 모두와 채팅을 하면 되는 단순한 기능이었습니다. 하지만 대마장터는 판매자와 구매자 사이의 1대1 채팅을 구현해야 했습니다. 그래서 socket.io를 더 자세히 알아보게 되었고, 채팅 기록 저장, 채팅방 접속 등 지금껏 해보지 않았던 새로운 처리를 해볼 수 있어 좋았습니다.

#### dotenv? 와우!

 이전 프로젝트인 알법에서는 dotenv의 존재를 몰랐습니다. 따라서 당시에는 코드를 깃허브에 올릴 때 중요한 내용을 지워줘야 하는 것이 너무 불편했습니다. 하지만 대마장터를 개발할 때 dotenv를 적용함으로써 .gitignore도 사용해볼 수 있었고, 중요한 정보를 굳이 하드코딩하지 않아도 되서 좋았습니다.

#### Sequelize를 조~금 더 깊이 써보다

 이전에는 써보지 않았던 것들을 쓸 수 있어서 좋았습니다. 예를 들면 [Op.and], [Op.or] 같은 특수 연산자 들이나. READ 작업을 할 때 attributes, limit, offset, order 같은 속성을 새롭게 사용해 보았습니다.

#### aws 탐구

 https와 도메인을 적용하기 위해서 많은 검색과 탐색을 하였습니다. 도메인과 https를 적용시킨 후 요청과 응답이 잘 오가는 것을 보았을 때 정말 기분이 좋았습니다. 이전 까지는 EC2의 인스턴스만 사용한 반면 대마장터를 개발할 때는 Certificate Manager, route 53, 로드 밸런서 등 aws가 제공하는 것들을 다양하게 사용해볼 수 있어서 즐거웠던 것 같습니다.

#### 탐구 그리고... 실수

 aws를 많이 알아본 것은 좋았으나, 예상치 못한 실수를 해버렸습니다. 프리티어 한도를 제대로 숙지하지 않아서 요금이 발생해 버렸습니다. 앞으로 프리티어 한계치에 대해서 잘 숙지하고 메일도 자주 확인해야겠다는걸 느꼈습니다.

#### 툴을 적극적으로 사용하자

 Trello, Slack 같은 툴을 사용하기로 하였지만, 갈수록 팀원들 모두가 페이스북 메신저로 이야기했던 것 같습니다. 툴을 적극 활용하여 개발과 협업을 효율적으로 하는 것이 중요한 것 같습니다.

#### MySQL 외부접속과 인공지능 도입

 게시물을 추천하기 위하여 인공지능 분야 개발을 맡은 팀원이 있었습니다. 그 팀원의 요청으로 MySQL 외부접속을 허용해보는 경험도 새로웠고, 제 서버에서 다른 API를 호출하는 경험도 새로웠습니다. 여러 분야와의 융합도 서비스 개발에 있어서 즐거운 일 중 하나인 것 같습니다.

#### Async Await 문법 적용

 대마장터에 Async Await를 적용해보았습니다. 코드가 정말 깔끔하고 예뻐지는 걸 보았고, 다양한 모듈에 대한 탐구도 좋지만, 편리한 문법에 대한 탐구도 개발 효율을 증진시키기 위해서 중요하다는 것을 크게 깨우친 것 같습니다.

#### 사용하는 언어부터 제대로 알자

 지금까지는 그냥 Node.js 책을 조금 읽고 나면 자바스크립트를 자세히 몰라도 어느 정도 개발을 할 수 있었기 때문에 소홀히 했던 감이 있습니다. 그런데 대마장터를 개발할 때 문제가 생겼습니다. forEach문의 콜백 안에서는 await문을 쓸 수 없었던 겁니다. 정말 당황해서 "이제 코드를 어떻게 짜야하지.." 라는 고민만 계속 하고 있었는데 결국 고민 끝에 나온 결과는 for of 문을 사용하면 된다는 것이었습니다. 언어에 대한 기본적인 지식부터 다시 쌓아야 겠다는 생각을 하게 되었습니다.

#### 맹신하지 말자
 채팅을 구현하는 중 자꾸만 앱에서 연결했을 때 자동으로 disconnect가 발생하였습니다. 거의 일주일 동안 해결하려고 삽을 팠었는데, 정말 허무하게 문제가 해결되었습니다. 클라이언트 측에서 socket.io의 버전을 낮추었더니 커넥션 상태가 정상적으로 유지되었습니다. 모듈은 완벽하게 동작할 것이라고 맹신했던 저의 문제였습니다. 항상 특정 버전을 사용할 때, 그 버전에 대한 이슈를 확인해 보는 것이 좋겠다는 것을 깨달았습니다.

## 마지막

 대마장터는 지금까지의 프로젝트 중에서 가장 규모가 컸고, 그만큼 배우고 느끼고 성장한 부분도 많은 것 같습니다. 개발 기간이 가장 길은 만큼 대마장터를 개발하면서 많은 생각을 해볼 수 있었습니다.